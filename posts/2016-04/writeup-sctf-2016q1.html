<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Write-Up - sCTF.io - 2016Q1</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="n00bsb Brazilian ctf-team">
    <meta name="author" content="n00bsbot">

    <!-- Styles -->
    <link rel="stylesheet" href="../../theme/css/n00bsb.css" type="text/css" />
<!--    <link href="../../theme/css/pygments.css" rel="stylesheet">  -->
    <link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

    <!-- Favivon and touch icons -->
    <link rel="shortcut icon" href="../../theme/img/favicon.ico">
    <link rel="apple-touch-icon" href="../../theme/img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../../theme/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../../theme/img/apple-touch-icon-114x114.png">
  </head>

  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <div class="nav-collapse">
            <ul class="nav">
              <li class="nav pull-left"><a href="../../sobre.html">Sobre</a></li>
              <li class="nav pull-left"><a href="../../archives.html">Archive</a></li>
              <li class="active"><a href="../../category/ctf.html">CTF</a></li>
              <li ><a href="../../category/wargames.html">Wargames</a></li>
              <!-- <ul class="nav pull-right"> -->
              <!-- </ul -->
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
<div>
    <br>
    <a class="ascii-logo" href="../../index.html">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.d8888b.&nbsp;&nbsp;.d8888b.&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d88P&nbsp;&nbsp;Y88bd88P&nbsp;&nbsp;Y88b888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        88888b.&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;88888888b.&nbsp;.d8888b&nbsp;88888b.&nbsp;&nbsp;<br>
        888&nbsp;"88b888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;"88b88K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;"88b&nbsp;<br>
        888&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;888"Y8888b.888&nbsp;&nbsp;888&nbsp;<br>
        888&nbsp;&nbsp;888Y88b&nbsp;&nbsp;d88PY88b&nbsp;&nbsp;d88P888&nbsp;d88P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X88888&nbsp;d88P&nbsp;<br>
        888&nbsp;&nbsp;888&nbsp;"Y8888P"&nbsp;&nbsp;"Y8888P"&nbsp;88888P"&nbsp;&nbsp;88888P'88888P"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brazilian CTF Team<br>
    </a>
<br><br>
</div>      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h2>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Write-Up - sCTF.io - 2016Q1">
                                        Write-Up - sCTF.io - 2016Q1
                                </a>
                        </h2>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Data</span>
<abbr class="published" title="17/04/2016">
    17/04/2016
</abbr>
    <span class="label">Por</span>
    <a href="#">atcasanova</a>
<span class="label">Categoria</span>
<a href="../../category/ctf.html">CTF</a>

    <span class="label">Tags</span>
	    <a href="../../tag/ctf.html">#ctf</a>
	    <a href="../../tag/sctf.html">#sctf</a>
	    <a href="../../tag/write-up.html">#write-up</a>

</footer><!-- /.post-info -->                </div>
                <h1><a href="https://github.com/n00bsb/sctf/tree/master/2016q1/Ducks">Ducks</a></h1>
<h2><a href="http://ducks.sctf.michaelz.xyz/">The ducks</a> and I have a unfinished score to settle.</h2>
<p>Hint: If you've remember HSF, you'll know that The Ducks is unsolvable.</p>
<p>This one was quite easy: since it gave us the <a href="http://ducks.sctf.michaelz.xyz/source.php">source code of the page</a> we could see that it uses the <a href="http://stackoverflow.com/questions/829407/what-is-so-wrong-with-extract">PHP extract()</a> function.</p>
<p>Our goal was then to send a POST that would override the <code>thepassword_123</code> variable:</p>
<p><code>wget -qO- --post-data="pass=abc&amp;thepassword_123=abc" http://ducks.sctf.michaelz.xyz/</code></p>
<p>and within the output, there it is:</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #d0d0d0">&lt;</span><span style="color: #6ab825; font-weight: bold">h1</span><span style="color: #d0d0d0">&gt;</span>The Ducks<span style="color: #d0d0d0">&lt;/</span><span style="color: #6ab825; font-weight: bold">h1</span><span style="color: #d0d0d0">&gt;</span>
<span style="color: #d0d0d0">&lt;</span><span style="color: #6ab825; font-weight: bold">div</span> <span style="color: #bbbbbb">class</span><span style="color: #d0d0d0">=</span><span style="color: #ed9d13">&quot;alert alert-success&quot;</span><span style="color: #d0d0d0">&gt;</span>
<span style="color: #d0d0d0">&lt;</span><span style="color: #6ab825; font-weight: bold">code</span><span style="color: #d0d0d0">&gt;</span>sctf{maybe_i_shouldn&#39;t_have_extracted_everything_huh}<span style="color: #d0d0d0">&lt;/</span><span style="color: #6ab825; font-weight: bold">code</span><span style="color: #d0d0d0">&gt;</span>
<span style="color: #d0d0d0">&lt;/</span><span style="color: #6ab825; font-weight: bold">div</span><span style="color: #d0d0d0">&gt;</span>
</pre></div>


<hr />
<h1><a href="https://github.com/n00bsb/sctf/blob/master/2016q1/LengthyLingo/README.md">LenghtyLingo</a></h1>
<h2>Description:</h2>
<p>Can you crack the code? We intercepted this flag but can't seem to figure out how it was encrypted.</p>
<p>The solution is quite simple. You have to count the length of each word, then convert its number to ascii.
I've came up with this one-liner:</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>sed <span style="color: #ed9d13">&#39;s/, /\n/g&#39;</span> encrypted.dat <span style="color: #d0d0d0">|</span> <span style="color: #6ab825; font-weight: bold">while</span> <span style="color: #24909d">read</span> i<span style="color: #d0d0d0">;</span> <span style="color: #6ab825; font-weight: bold">do</span> <span style="color: #24909d">printf</span> <span style="color: #ed9d13">&quot;\x</span><span style="color: #6ab825; font-weight: bold">$(</span><span style="color: #24909d">printf</span> %x <span style="color: #ed9d13">${#</span><span style="color: #40ffff">i</span><span style="color: #ed9d13">}</span><span style="color: #6ab825; font-weight: bold">)</span><span style="color: #ed9d13">&quot;</span><span style="color: #d0d0d0">;</span> <span style="color: #6ab825; font-weight: bold">done</span>
</pre></div>


<hr />
<h1><a href="https://github.com/n00bsb/sctf/tree/master/2016q1/RainOrShine">Rain Or Shine</a></h1>
<p>This one we couldn't crack in time, mostly because I first found a JPEG signature which turned out to be just the thumbnail of the original image, what cost us a lot of time, and also because GIMP wouldn't open layered TIFFs. </p>
<p>Because of this, we spent a lot of time trying to manually reassemble the QR Code, which was impossible since there were overlayed layers.</p>
<p>By the time I got access to a friend with Photoshop, the challenge was ended.</p>
<p>Cutting to the chase: Open the <code>rain.wav</code> file in your favourite hex editor (mine is bless). Keep digging until you find a TIFF header:</p>
<p><strong>49492a0008</strong></p>
<p>So what we'll have to do is cut the file from this header until the end: </p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>xxd -p rain.wav <span style="color: #d0d0d0">|</span> tr -d <span style="color: #ed9d13">&#39;\n&#39;</span> <span style="color: #d0d0d0">|</span> grep -Eo <span style="color: #ed9d13">&quot;49492a0008[0-9a-f]*&quot;</span> <span style="color: #d0d0d0">|</span> xxd -r -p &gt; file.tiff
</pre></div>


<p>and then open it with Photoshop (GIMP apparently has some issues managing layered TIFFs), where you can see four layers and easily rearrange them.</p>
<p>The result is a QRCode that you could read with your phone or using zbar-tools</p>
<hr />
<h1><a href="https://github.com/n00bsb/sctf/tree/master/2016q1/Verticode">Verticode</a></h1>
<h2>Description:</h2>
<p>Welcome to Verticode, the new method of translating text into vertical codes.</p>
<p>Each verticode has two parts: the color shift and the code.</p>
<p>The code takes the inputted character and translates it into an ASCII code, and then into binary, then puts that into an image in which each black pixel represents a 1 and each white pixel represents a 0.</p>
<p>For example, A is 65 which is 1000001 in binary, B is 66 which is 1000010, and C is 67 which is 1000011, so the corresponding verticode would look like this.</p>
<p>Except, it isn't that simple.</p>
<p>A color shift is also integrated, which means that the color before each verticode shifts the ASCII code, by adding the number that the color corresponds to, before translating it into binary. In that case, the previous verticode could also look like this.</p>
<p>The table for the color codes is:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Color</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Red</td>
</tr>
<tr>
<td>1</td>
<td>Purple</td>
</tr>
<tr>
<td>2</td>
<td>Blue</td>
</tr>
<tr>
<td>3</td>
<td>Green</td>
</tr>
<tr>
<td>4</td>
<td>Yellow</td>
</tr>
<tr>
<td>5</td>
<td>Orange</td>
</tr>
</tbody>
</table>
<p>This means that a red color shift for the letter A, which is 65 + 0 = 65, would translate into 1000001 in binary; however, a green color shift for the letter A, which is 65 + 3 = 68, would translate into 1000100 in binary.</p>
<p>Given this verticode, read the verticode into text and find the flag.</p>
<p>Note that the flag will not be in the typical sctf{flag} format, but will be painfully obvious text. Once you find this text, you will submit it in the sctf{text} format. So, if the text you find is adunnaisawesome, you will submit it as sctf{adunnaisawesome}.</p>
<h1>decode.sh</h1>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #999999; font-style: italic">#!/bin/bash</span>
<span style="color: #d0d0d0">((</span> <span style="color: #40ffff">$#</span> !<span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span> <span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #d0d0d0">{</span> <span style="color: #24909d">echo</span> <span style="color: #ed9d13">&quot;please specify input file&quot;</span><span style="color: #d0d0d0">;</span> <span style="color: #24909d">exit</span> 1<span style="color: #d0d0d0">;</span> <span style="color: #d0d0d0">}</span>

<span style="color: #999999; font-style: italic"># constants:</span>
<span style="color: #40ffff">line_height</span><span style="color: #d0d0d0">=</span>12
<span style="color: #40ffff">pixel_width</span><span style="color: #d0d0d0">=</span>12
<span style="color: #40ffff">line_width</span><span style="color: #d0d0d0">=</span>168
<span style="color: #40ffff">color_width</span><span style="color: #d0d0d0">=</span>83

<span style="color: #999999; font-style: italic"># convert png to txt using ImageMagick&#39;s convert</span>
convert <span style="color: #40ffff">$1</span> txt: &gt; out.txt
sed -i <span style="color: #ed9d13">&#39;1d&#39;</span> out.txt
<span style="color: #40ffff">lines</span><span style="color: #d0d0d0">=</span><span style="color: #6ab825; font-weight: bold">$(</span>tail -1 out.txt <span style="color: #d0d0d0">|</span> cut -f2 -d, <span style="color: #d0d0d0">|</span> cut -f1 -d:<span style="color: #6ab825; font-weight: bold">)</span>

<span style="color: #999999; font-style: italic"># get just one line of pixels for each real line in the image</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">((</span> <span style="color: #40ffff">i</span><span style="color: #d0d0d0">=</span>0<span style="color: #d0d0d0">;</span> i&lt;<span style="color: #40ffff">$lines</span><span style="color: #d0d0d0">;</span> i+<span style="color: #d0d0d0">=</span><span style="color: #40ffff">$line_height</span> <span style="color: #d0d0d0">));</span> <span style="color: #6ab825; font-weight: bold">do</span> 
    grep -E <span style="color: #ed9d13">&quot;^[0-9]*,</span><span style="color: #40ffff">$i</span><span style="color: #ed9d13">: &quot;</span> out.txt <span style="color: #d0d0d0">;</span> 
<span style="color: #6ab825; font-weight: bold">done</span> &gt; lines.txt

<span style="color: #999999; font-style: italic"># get just one pixel per needed column in the original image</span>
&gt;sane.txt
<span style="color: #6ab825; font-weight: bold">for</span> i in <span style="color: #6ab825; font-weight: bold">$(</span>cat lines.txt <span style="color: #d0d0d0">|</span> cut -f2 -d, <span style="color: #d0d0d0">|</span> cut -f1 -d: <span style="color: #d0d0d0">|</span> sort -nu<span style="color: #6ab825; font-weight: bold">)</span><span style="color: #d0d0d0">;</span> <span style="color: #6ab825; font-weight: bold">do</span>
    <span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">((</span> <span style="color: #40ffff">j</span><span style="color: #d0d0d0">=</span><span style="color: #40ffff">$color_width</span><span style="color: #d0d0d0">;</span> j&lt;<span style="color: #40ffff">$line_width</span><span style="color: #d0d0d0">;</span> j+<span style="color: #d0d0d0">=</span><span style="color: #40ffff">$pixel_width</span> <span style="color: #d0d0d0">));</span> <span style="color: #6ab825; font-weight: bold">do</span> 
        grep <span style="color: #ed9d13">&quot;^</span><span style="color: #40ffff">$j</span><span style="color: #ed9d13">,</span><span style="color: #40ffff">$i</span><span style="color: #ed9d13">: &quot;</span> lines.txt &gt;&gt; sane.txt
    <span style="color: #6ab825; font-weight: bold">done</span>
<span style="color: #6ab825; font-weight: bold">done</span> 

<span style="color: #999999; font-style: italic"># each &quot;line&quot; in one line</span>
cat sane.txt <span style="color: #d0d0d0">|</span> tr -s <span style="color: #ed9d13">&#39; &#39;</span> <span style="color: #d0d0d0">|</span> sed <span style="color: #ed9d13">&#39;s/, /,/g;s/( /(/g&#39;</span> <span style="color: #d0d0d0">|</span> cut -f4 -d <span style="color: #ed9d13">&quot; &quot;</span> <span style="color: #d0d0d0">|</span> xargs -L8 &gt; end.txt

<span style="color: #999999; font-style: italic"># black and white to binary</span>
sed <span style="color: #ed9d13">&#39;s/ black/1/g;s/ white/0/g&#39;</span> end.txt <span style="color: #d0d0d0">|</span> sed <span style="color: #ed9d13">&#39;s/^[a-z]*/\0 /g&#39;</span> &gt;ideal.txt

<span style="color: #999999; font-style: italic"># binary conversion, color conversion and mathematics, then print ascii code</span>
paste -d-  &lt;<span style="color: #d0d0d0">(</span><span style="color: #6ab825; font-weight: bold">for</span> i in <span style="color: #6ab825; font-weight: bold">$(</span>cat ideal.txt <span style="color: #d0d0d0">|</span> cut -f2 -d<span style="color: #ed9d13">&quot; &quot;</span><span style="color: #6ab825; font-weight: bold">)</span><span style="color: #d0d0d0">;</span> <span style="color: #6ab825; font-weight: bold">do</span> <span style="color: #24909d">echo</span> <span style="color: #6ab825; font-weight: bold">$((</span><span style="color: #3677a9">2#</span><span style="color: #40ffff">$i</span><span style="color: #6ab825; font-weight: bold">))</span><span style="color: #d0d0d0">;</span> <span style="color: #6ab825; font-weight: bold">done</span><span style="color: #d0d0d0">)</span> ideal.txt &gt; last.txt
<span style="color: #6ab825; font-weight: bold">for</span> i in <span style="color: #6ab825; font-weight: bold">$(</span>cat last.txt <span style="color: #d0d0d0">|</span> cut -f1 -d<span style="color: #ed9d13">&quot; &quot;</span> <span style="color: #d0d0d0">|</span> sed <span style="color: #ed9d13">&#39;s|red|0|g;s|purple|1|g;s|blue|2|g;s|green|3|g;s|yellow|4|g;s|orange|5|g&#39;</span><span style="color: #d0d0d0">|</span> bc<span style="color: #6ab825; font-weight: bold">)</span><span style="color: #d0d0d0">;</span> <span style="color: #6ab825; font-weight: bold">do</span> 
    <span style="color: #24909d">printf</span> <span style="color: #ed9d13">&quot;\x</span><span style="color: #6ab825; font-weight: bold">$(</span><span style="color: #24909d">printf</span> %x <span style="color: #40ffff">$i</span><span style="color: #6ab825; font-weight: bold">)</span><span style="color: #ed9d13">&quot;</span><span style="color: #d0d0d0">;</span>
<span style="color: #6ab825; font-weight: bold">done</span>
<span style="color: #24909d">echo</span>
</pre></div>


<h2>Running:</h2>
<p><code>chmod +x decode.sh</code>
then
<code>./decode.sh code1.png</code></p>
<p>Sorry about the great number of temporary files, but I did this step by step on the shell :)</p>
<hr />
<h1><a href="https://github.com/n00bsb/sctf/tree/master/2016q1/Vertinet">Vertinet</a></h1>
<h1>Description:</h1>
<p>This problem follows the same specifications as the previous Verticode, except that you have to solve many of them by developing a client to communicate with the server available at problems1.2016q1.sctf.io:50000. Good luck.</p>
<h1>client.sh</h1>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #40ffff">start</span><span style="color: #d0d0d0">=</span>0<span style="color: #d0d0d0">;</span>
<span style="color: #40ffff">print</span><span style="color: #d0d0d0">=</span>0<span style="color: #d0d0d0">;</span>
<span style="color: #6ab825; font-weight: bold">while</span> <span style="color: #24909d">read</span> -n1 char<span style="color: #d0d0d0">;</span>
<span style="color: #6ab825; font-weight: bold">do</span>
        <span style="color: #d0d0d0">((</span> <span style="color: #40ffff">$print</span> <span style="color: #d0d0d0">==</span> <span style="color: #3677a9">1</span> <span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #24909d">echo</span> -n <span style="color: #40ffff">$char</span><span style="color: #d0d0d0">;</span>
        <span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">[</span> <span style="color: #ed9d13">&quot;</span><span style="color: #40ffff">$char</span><span style="color: #ed9d13">&quot;</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;,&quot;</span> <span style="color: #d0d0d0">];</span> <span style="color: #6ab825; font-weight: bold">then</span>
            <span style="color: #40ffff">start</span><span style="color: #d0d0d0">=</span>1<span style="color: #d0d0d0">;</span> <span style="color: #6ab825; font-weight: bold">continue</span><span style="color: #d0d0d0">;</span>
        <span style="color: #6ab825; font-weight: bold">fi</span>
        <span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">[</span> <span style="color: #ed9d13">&quot;</span><span style="color: #40ffff">$char</span><span style="color: #ed9d13">&quot;</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;&#39;&quot;</span> <span style="color: #d0d0d0">];</span> <span style="color: #6ab825; font-weight: bold">then</span>
            <span style="color: #40ffff">start</span><span style="color: #d0d0d0">=</span>0<span style="color: #d0d0d0">;</span>
        <span style="color: #6ab825; font-weight: bold">fi</span>
        <span style="color: #d0d0d0">((</span> <span style="color: #40ffff">$abriu</span> <span style="color: #d0d0d0">==</span> 1<span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #d0d0d0">{</span>
            resp+<span style="color: #d0d0d0">=</span><span style="color: #40ffff">$char</span><span style="color: #d0d0d0">;</span> 
        <span style="color: #d0d0d0">}</span>
        <span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">((</span> <span style="color: #ed9d13">${#</span><span style="color: #40ffff">resp</span><span style="color: #ed9d13">}</span> &gt; <span style="color: #3677a9">1500</span> <span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #d0d0d0">((</span> <span style="color: #40ffff">$abriu</span> <span style="color: #d0d0d0">==</span> <span style="color: #3677a9">0</span> <span style="color: #d0d0d0">));</span> <span style="color: #6ab825; font-weight: bold">then</span>
            <span style="color: #24909d">echo</span> -n <span style="color: #ed9d13">&quot;${</span><span style="color: #40ffff">resp</span><span style="color: #ed9d13">}&quot;</span> <span style="color: #d0d0d0">|</span> base64 -d &gt;/dev/null <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #d0d0d0">{</span>
                <span style="color: #24909d">echo</span> -n <span style="color: #ed9d13">&quot;${</span><span style="color: #40ffff">resp</span><span style="color: #ed9d13">}&quot;</span> <span style="color: #d0d0d0">|</span> base64 -d &gt; file.png
                <span style="color: #40ffff">print</span><span style="color: #d0d0d0">=</span>1<span style="color: #d0d0d0">;</span>
                <span style="color: #40ffff">answer</span><span style="color: #d0d0d0">=</span><span style="color: #6ab825; font-weight: bold">$(</span>../Verticode/decode.sh file.png<span style="color: #6ab825; font-weight: bold">)</span>
                <span style="color: #24909d">echo</span> -n <span style="color: #40ffff">$answer</span> &gt;<span style="color: #d0d0d0">&amp;</span>4
                <span style="color: #40ffff">resp</span><span style="color: #d0d0d0">=</span>
            <span style="color: #d0d0d0">}</span> <span style="color: #d0d0d0">||</span> <span style="color: #40ffff">print</span><span style="color: #d0d0d0">=</span>0<span style="color: #d0d0d0">;</span>
        <span style="color: #6ab825; font-weight: bold">fi</span>
<span style="color: #6ab825; font-weight: bold">done</span> &lt;<span style="color: #d0d0d0">&amp;</span>3
</pre></div>


<h2>Running</h2>
<p><code>chmod +x client.sh</code></p>
<p>then</p>
<p><code>socat TCP4:problems1.2016q1.sctf.io:50000 EXEC:/full/path/to/client.sh,fdin=3,fdout=4</code></p>
<p>Maybe you'll need to install <code>socat</code> first</p>
<hr />
<h1><a href="https://ctftime.org/task/2258">Failed Compression</a></h1>
<p>This one was a pain in the *ss. I opened the file (compressed.zip, 73mb) and found a lot of JPEG JFIF broken headers, and also PNG IHDR ones.</p>
<p>I was REALLY bored to code something nice to extract all the files, so I thought I could use some luck this time. Then I focused on the JPEG files.</p>
<p>Before you continue, I'd like you to know that I'm not proud of the following lines ;)</p>
<h2>1. Convert the file to hex</h2>
<p><code>xxd -p compressed.zip | tr -d "\n" &gt; hex</code></p>
<h2>2. Make an ugly loop to isolate the JPEG markers within spaces using an uglier sed.</h2>
<p><code>j=0; for i in $(cat hex | sed 's/e000104a/ STARTHERE/g;s/ae4260/ENDHERE /g'); do  echo $i &gt; $j.j;  let j++;  done;</code></p>
<h2>3. Loop all the files, now fixing the headers and footers, then converting back from hex to file.</h2>
<p><code>for i in *.j ; do  sed -i 's/STARTHERE/ffd8ffe000104a/g;s/ENDHERE/ae4260/g' $i; xxd -r -p $i &gt; ${i}pg ; done;</code></p>
<h2>4. For easy browsing, let's make a HTML file with all the valid JPEG files</h2>
<p><code>for i in $(file *.jpg| grep JPEG | cut -f1 -d:); do echo "&lt;img src='$i'&gt;" &gt;&gt; index.html; done</code></p>
<p>As I said, we needed luck. The flag was in one of the jpeg files :)
Take a look at 264.jpg</p>
<hr />
                </div><!-- /.entry-content -->
        </article>
</section>
        </div><!--/span-->
        <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4>Membros</h4></li>
    <li><a target="_blank" href="https://github.com/atcasanova">atcasanova</a></li>
    <li><a target="_blank" href="https://">deadcow</a></li>
    <li><a target="_blank" href="https://github.com/fallc0nn">fallc0nn</a></li>
    <li><a target="_blank" href="https://">kirah</a></li>
    <li><a target="_blank" href="https://">Odysseus</a></li>
<li class="nav-header"><h4>Links</h4></li>
    <li><a target="_blank" href="https://asciinema.org/~fallc0nn">Asciinema (fallc0nn)</a></li>
    <li><a target="_blank" href="https://ctftime.org/team/24500">CTF-Time</a></li>
    <li><a target="_blank" href="https://github.com/n00bsb">Github</a></li>

<li class="nav-header"><h4>Categorias</h4></li>
<li><a href="../../category/ctf.html">CTF</a></li>
<li><a href="../../category/wargames.html">Wargames</a></li>

<li class="nav-header"><h4></i>Tags</h4></li>
<li class="tag-[<pelican.contents.Article object at 0x7fd2af527a50>]"><a href="../../tag/ctf.html">#ctf</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7fd2af4f3dd0>, <pelican.contents.Article object at 0x7fd2af405dd0>]"><a href="../../tag/overthewireorg.html">#overthewire.org</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7fd2af527a50>]"><a href="../../tag/sctf.html">#sctf</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7fd2af4f3dd0>, <pelican.contents.Article object at 0x7fd2af405dd0>]"><a href="../../tag/wargames.html">#wargames</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7fd2af527a50>, <pelican.contents.Article object at 0x7fd2af4f3dd0>, <pelican.contents.Article object at 0x7fd2af405dd0>]"><a href="../../tag/write-up.html">#write-up</a></li>

</ul>        </div><!--/.well -->
      </div><!--/row-->

      <footer></footer>
    
    </div><!--/.fluid-container-->
  </body>
</html>