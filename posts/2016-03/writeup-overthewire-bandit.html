<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Write-Up - OverTheWire - Bandit</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="n00bsb Brazilian ctf-team">
    <meta name="author" content="n00bsbot">

    <!-- Styles -->
    <link rel="stylesheet" href="../../theme/css/n00bsb.css" type="text/css" />
<!--    <link href="../../theme/css/pygments.css" rel="stylesheet">  -->
    <link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

    <!-- Favivon and touch icons -->
    <link rel="shortcut icon" href="../../theme/img/favicon.ico">
    <link rel="apple-touch-icon" href="../../theme/img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../../theme/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../../theme/img/apple-touch-icon-114x114.png">
  </head>

  <body>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <div class="nav-collapse">
            <ul class="nav">
              <li class="nav pull-left"><a href="../../sobre.html">Sobre</a></li>
              <li class="nav pull-left"><a href="../../archives.html">Archive</a></li>
              <li ><a href="../../category/ctf.html">CTF</a></li>
              <li class="active"><a href="../../category/wargames.html">Wargames</a></li>
              <!-- <ul class="nav pull-right"> -->
              <!-- </ul -->
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
<div>
    <br>
    <a class="ascii-logo" href="../../index.html">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.d8888b.&nbsp;&nbsp;.d8888b.&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d88P&nbsp;&nbsp;Y88bd88P&nbsp;&nbsp;Y88b888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
        88888b.&nbsp;888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;88888888b.&nbsp;.d8888b&nbsp;88888b.&nbsp;&nbsp;<br>
        888&nbsp;"88b888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;"88b88K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;888&nbsp;"88b&nbsp;<br>
        888&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;&nbsp;&nbsp;888888&nbsp;&nbsp;888"Y8888b.888&nbsp;&nbsp;888&nbsp;<br>
        888&nbsp;&nbsp;888Y88b&nbsp;&nbsp;d88PY88b&nbsp;&nbsp;d88P888&nbsp;d88P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X88888&nbsp;d88P&nbsp;<br>
        888&nbsp;&nbsp;888&nbsp;"Y8888P"&nbsp;&nbsp;"Y8888P"&nbsp;88888P"&nbsp;&nbsp;88888P'88888P"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Brazilian CTF Team<br>
    </a>
<br><br>
</div>      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h2>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Write-Up - OverTheWire - Bandit">
                                        Write-Up - OverTheWire - Bandit
                                </a>
                        </h2>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Data</span>
<abbr class="published" title="15/03/2016">
    15/03/2016
</abbr>
    <span class="label">Por</span>
    <a href="#">atcasanova</a>
<span class="label">Categoria</span>
<a href="../../category/wargames.html">Wargames</a>

    <span class="label">Tags</span>
	    <a href="../../tag/overthewireorg.html">#overthewire.org</a>
	    <a href="../../tag/wargames.html">#wargames</a>
	    <a href="../../tag/write-up.html">#write-up</a>

</footer><!-- /.post-info -->                </div>
                <p>O <a href="http://overthewire.org/wargames/bandit/bandit0.html">bandit</a> é um dos muitos interessantíssimos challenges disponíveis no <a href="http://overthewire.org/wargames/">Overthewire</a> que eu e o <strong>fallc0nn</strong> começamos a fazer há algum tempo.<br />
Nesse post vamos postar o walkthru desse challenge.</p>
<h2>Level 0</h2>
<p>O level 0 é extremamente simples. Basta logar no servidor e dar um cat no arquivo readme</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>ssh bandit0@bandit.labs.overthewire.org
cat readme
</pre></div>


<p>e usar a senha encontrada para dar ssh para o próximo level</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>ssh bandit1@localhost
</pre></div>


<h2>Level 1</h2>
<p>O level 1 exige um conhecimento básico de linux, mas que muita gente não sabe.</p>
<p>Ao se logar, você verá um arquivo chamado “-“. Isso mesmo, é só o famoso dash, ou traço.<br />
De cara, todos tentariam dar um <strong>cat –</strong> ou <strong>cat -</strong>, mas não funcionaria. Alguns programas do linux adotam uma convenção de que o – sozinho significa stdout. Assim, temos duas formas de resolver o problema:</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>cat ./-
# ou
cat &lt; -
</pre></div>


<p>e usar a senha encontrada para dar ssh para o próximo level</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>ssh bandit2@localhost
</pre></div>


<h2>Level 2</h2>
<p>O 2 não vale nem a pena perder tempo. É um arquivo com espaços no filename, onde você deveria escapar os espaços para conseguir dar o cat.<br />
Porém, o tab completion faz isso por você.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>cat spaces\ in\ this\ filename
</pre></div>


<p>novamente, use a senha para logar como bandit3.</p>
<h2>Level 3</h2>
<p>Como o dois, bem simples. Uma pasta com um arquivo oculto dentro.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>cat .hidden
</pre></div>


<p>Agora é só fazer o login como bandit4</p>
<h2>Level 4</h2>
<p>O 4 também tem uma pegadinha que pouca gente sabe.<br />
Tratar arquivos que começam com dash (-) tem uma particularidade no linux. Quando você usa um comando e ele vê o caractere -, ele espera que você esteja começando a setar argumentos do programa, como “ls -lA” ou “cat -vet”.<br />
Portanto, existe uma forma não tão conhecida de avisar ao programa em questão que você acabou de informar seus argumentos, que é utilizando dois traços (–).<br />
Nesse nível temos os seguintes arquivos:</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>-file00
-file01
-file02
-file03
-file04
-file05
-file06
-file07
-file08
-file09
</pre></div>


<p>e se você tentar dar um simples cat em qualquer um deles, dará erro.<br />
Então, deve utilizar a dica dos dois traços. Mas antes disso, você vai perceber que dentro da maioria dos arquivos existem strings ininteligíveis. Para evitar ter que dar cat em todos, faça:</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>$ file -- *
-file00: data
-file01: data
-file02: data
-file03: data
-file04: data
-file05: data
-file06: data
-file07: ASCII text
-file08: data
-file09: data
</pre></div>


<p>e assim saberá que a senha está no arquivo “-file07”.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>cat -- -file07
# ou
cat &lt; -file07
</pre></div>


<h2>Level 5</h2>
<p>O level 5 é o mais chato até aqui<br />
Basta dar um ls -R para ver que existem dezenas de pastas e subpastas e arquivos… demoraria horas para encontrar a senha olhando um por um.<br />
Vou economizar na explicação dos problemas, pois todos já encontramos até aqui, e focar na solução:<br />
A melhor forma que encontrei aqui foi listar todos os arquivos com <strong>find -type f</strong>, adicionar aspas em volta deles, para evitar problemas com espaços, com <strong>sed ‘s/^\|$/\”/g’</strong> e jogar o output para o comando <strong>file —</strong> (lembram dos dois traços?).<br />
Porém, a lista de arquivos é imensa. Como até aqui já aprendemos que a senha vem num arquivo texto, podemos usar <strong>grep ASCII</strong> na saída do file –, assim nosso universo foi reduzido a poucos arquivos.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>find -type f | sed &#39;s/^\|$/\&quot;/g&#39;  | xargs file --  | grep ASCII
</pre></div>


<p>Com essas informações, tudo que precisamos é, depois do pipe, dar um cut, fazer novamente o truque das aspas e jogar o output para um <strong>xargs head -1</strong></p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>find -type f | sed &#39;s/^\|$/\&quot;/g&#39;  | xargs file --  | grep ASCII | cut -f1 -d: | sed &#39;s/^\|$/\&quot;/g&#39; | xargs head -1 | less
</pre></div>


<p>Se você prestou atenção no formato das senhas até agora, vai identificar só de olhar!</p>
<p>MAS<br />
isso tudo é pra quem é desatento, e num CTF toda informação é valiosa.<br />
Na página do challenge, no item “level 5 – level6” tem uma dica de ouro:<br />
“<em>The password for the next level is stored in a file somewhere under the inhere directory and has all of the following properties: – human-readable – 1033 bytes in size – not executable</em>”  </p>
<p>Então basta fazer:</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>$ find -size 1033c | xargs cat
</pre></div>


<p>e correr para o abraço. E, a partir de agora, ficar olho no site!</p>
<h2>Level 6</h2>
<p>Seguindo as intruções do site, temos os atributos do arquivo:user: bandit7, group: bandit6, size: 33 bytes.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>find / -user bandit7 -group bandit6 -size 33c | xargs cat
</pre></div>


<h2>Level 7</h2>
<p>Instruções no site!</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>grep millionth data.txt
</pre></div>


<h2>Level 8</h2>
<p>A senha está no arquivo data.txt e é a única linha que aparece apenas uma vez</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>sort data.txt | uniq -u
</pre></div>


<h2>Level 9</h2>
<p>A senha está em uma das poucas linhas ‘legíveis’ do arquivo data.txt que começam com algumas vezes o caractere “=”<br />
Para esse nível vamos usar pela primeira vez o comando <strong>strings</strong></p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>strings data.txt  | grep -E &quot;^=+&quot;
</pre></div>


<h2>Level 10</h2>
<p>A senha está no arquivo data.txt, codificado em base64</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>base64 -d &lt; data.txt
</pre></div>


<h2>Level 11</h2>
<p>O level 11 é a conhecida cifra de césar, algoritmo de rotação de caracteres.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>tr a-zA-Z n-za-mN-ZA-M &lt; data.txt
</pre></div>


<h2>Level 12</h2>
<p>O 12 é bem chatinho. Se você der um cat no arquivo vai ver que se trata de um hexdump de algum arquivo.<br />
Muita gente ao fazer esse nível jogava o output para algum arquivo e dava um file, para depois usar algum outro comando, salvar em outro arquivo e dar outro file, assim sucessivamente.<br />
Mas como expliquei no level 1, podemos usar o – em alguns programas simbolizando o stdout. Então basta fazer o seguinte:</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>bandit12@melinda:~$ xxd -r data.txt | file -
/dev/stdin: gzip compressed data, was &quot;data2.bin&quot;, from Unix, last modified: Fri Nov 14 10:32:20 2014, max compression
bandit12@melinda:~$ xxd -r data.txt | zcat | file -
/dev/stdin: bzip2 compressed data, block size = 900k
bandit12@melinda:~$ xxd -r data.txt | zcat | bzcat| file -
/dev/stdin: gzip compressed data, was &quot;data4.bin&quot;, from Unix, last modified: Fri Nov 14 10:32:20 2014, max compression
bandit12@melinda:~$ xxd -r data.txt | zcat | bzcat| zcat| file -
/dev/stdin: POSIX tar archive (GNU)
bandit12@melinda:~$ xxd -r data.txt | zcat | bzcat| zcat| tar xO | file -
/dev/stdin: POSIX tar archive (GNU)
bandit12@melinda:~$ xxd -r data.txt | zcat | bzcat| zcat| tar xO | tar xO | file -
/dev/stdin: bzip2 compressed data, block size = 900k
bandit12@melinda:~$ xxd -r data.txt | zcat | bzcat| zcat| tar xO | tar xO | bzcat | file -
/dev/stdin: POSIX tar archive (GNU)
bandit12@melinda:~$ xxd -r data.txt | zcat | bzcat| zcat| tar xO | tar xO | bzcat | tar xO | file -
/dev/stdin: gzip compressed data, was &quot;data9.bin&quot;, from Unix, last modified: Fri Nov 14 10:32:20 2014, max compression
bandit12@melinda:~$ xxd -r data.txt | zcat | bzcat| zcat| tar xO | tar xO | bzcat | tar xO | zcat | file -
/dev/stdin: ASCII text
bandit12@melinda:~$ xxd -r data.txt | zcat | bzcat| zcat| tar xO | tar xO | bzcat | tar xO | zcat | cat
The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL
</pre></div>


<h2>Level 13</h2>
<p>Fácil, né?</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>ssh -i sshkey.private bandit14@localhost
</pre></div>


<p>Depois de logar, não se esqueça de pegar a senha</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>cat /etc/bandit_pass/bandit14
</pre></div>


<h2>Level 14</h2>
<p>A dica no site diz que se enviarmos a senha do nível atual na porta 30000 do servidor, receberemos a senha para o proximo.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>echo &quot;4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e&quot; | netcat localhost 30000
</pre></div>


<h2>Level 15</h2>
<p>O 15 é igual ao 14, mas via openssl</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>echo BfMYroe26WYalil77FoDi9qh59eK5xNr | openssl s_client -connect localhost:30001 -ign_eof
</pre></div>


<h2>Level 16</h2>
<p>Trabalhosa! O site informa que você deve sumeter a senha atual em uma porta no localhost entre 31000 e 32000, sem saber qual é.<br />
Recomenda que você primeiro veja quais portas estão abertas (nmap?) pra depois saber quais falam SSL e quais não falam, e então submeter a senha. Eu prefiro ganhar tempo:</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>for i in {31000..32000}; do
   netcat -zv localhost $i 2&gt;/dev/null &amp;&amp; {
      echo porta $i aberta;
      echo &quot;cluFn7wTiGryunymYOu4RcffSxQluehd&quot; | timeout 2 openssl s_client -connect localhost:$i -ign_eof ;
   };
done
</pre></div>


<p>Assim ele já vai enviar a string via SSL pra todas as portas abertas, depois basta você olhar o buffer do seu terminal pra encontrar a resposta.<br />
Nesse caso, temos como retorno uma chave privada que deve ser usada para acessar o próximo nível. O problema é que não temos permissão de escrita no diretório.<br />
Tentei salvar a key numa variavel e usar como file descriptor, mas pelo visto o sistema não permite. A solução, então, é criar no /tmp/.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>mkdir -p /tmp/n00bsb/
cd /tmp/n00bsb/
vi key
#(cole o conteúdo da key no arquivo)
ssh -i key bandit17@localhost
</pre></div>


<h2>Level 17</h2>
<p>A dica no site diz que a senha está na única linha que é diferente entre os arquivos passwords.new e passwords.old</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>diff passwords.*
</pre></div>


<p>Quando você tentar se logar no próximo level, vai ter uma surpresa…</p>
<h2>Level 18</h2>
<p>OOOOH! Não dá pra logar!!<br />
Mas a essa altura do campeonato você já sabe a solução. A dica no site diz que a senha está no arquivo readme do homedir do usuário</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>ssh bandit18@localhost cat readme
</pre></div>


<h2>Level 19</h2>
<p>Bem simples, nem sei porque está no final</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>./bandit20-do cat /etc/bandit_pass/bandit20
</pre></div>


<h2>Level 20</h2>
<p>Nesse level o enunciado diz que é preciso abrir dois shells pra passar. Mas como hackinagem pouca é bobagem, vou ensinar aqui como fazer com um shell só!<br />
Seguindo o enunciado, teoricamente você deveria abrir um listener com netcat, por exemplo</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>nc -l 12345
</pre></div>


<p>Depois abrir outra sessão ssh, executar</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>./suconnect 12345
</pre></div>


<p>Então, voltar ao primeiro terminal e submeter a key via listener, para que o suconnect enviasse a resposta de volta  </p>
<p>Muito trabalho, não?<br />
Aqui o negócio é simples.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>(sleep 10; echo GbKksEFF4yrVs6il55v6gwY5aVje5f0j) | nc -l 12345 &amp;
[1] 8230
./suconnect 12345
Read: GbKksEFF4yrVs6il55v6gwY5aVje5f0j
Password matches, sending next password
gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr
</pre></div>


<p>Deu pra entender? Na primeira linha abrimos o netcat escutando na porta 12345 e enviamos via pipe pra ele o comando agrupado entre parenteses para aguardar 10 segundos e depois enviar a key, já enviando tudo para background com o &amp; no final.<br />
Depois disso, é só digitar o ./suconnect 12345 em menos de 10 segundos e aguardar o tempo setado que a senha vai aparecer facilmente pra você!</p>
<h2>Level 21</h2>
<p>Dentro da pasta /etc/cron.d/ tem vários cronjobs de vários usuários. Nosso próximo level é o 22, nele que devemos focar.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>cat /etc/cron.d/cronjob_bandit22
* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
cat /usr/bin/cronjob_bandit22.sh
#!/bin/bash
chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</pre></div>


<p>Analisando o código, você pode ver que a senha do bandit22 está sendo enviada para aquele arquivo de nome estranho no /tmp<br />
É só dar um cat nele!</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI
</pre></div>


<h2>Level 22</h2>
<p>O início é igual ao level 21. Você deve verificar o cronjob do bandit23.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span><span style="color: #999999; font-style: italic">#!/bin/bash</span>

<span style="color: #40ffff">myname</span><span style="color: #d0d0d0">=</span><span style="color: #6ab825; font-weight: bold">$(</span>whoami<span style="color: #6ab825; font-weight: bold">)</span>
<span style="color: #40ffff">mytarget</span><span style="color: #d0d0d0">=</span><span style="color: #6ab825; font-weight: bold">$(</span><span style="color: #24909d">echo</span> I am user <span style="color: #40ffff">$myname</span> <span style="color: #d0d0d0">|</span> md5sum <span style="color: #d0d0d0">|</span> cut -d <span style="color: #ed9d13">&#39; &#39;</span> -f 1<span style="color: #6ab825; font-weight: bold">)</span>

<span style="color: #24909d">echo</span> <span style="color: #ed9d13">&quot;Copying passwordfile /etc/bandit_pass/</span><span style="color: #40ffff">$myname</span><span style="color: #ed9d13"> to /tmp/</span><span style="color: #40ffff">$mytarget</span><span style="color: #ed9d13">&quot;</span>

cat /etc/bandit_pass/<span style="color: #40ffff">$myname</span> &gt; /tmp/<span style="color: #40ffff">$mytarget</span>
</pre></div>


<p>Um poquinho de leitura de código resolve seu trabalho:</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>myname=bandit23
cat /tmp/$(echo I am user $myname | md5sum | cut -d &#39; &#39; -f 1)
jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n
</pre></div>


<h2>Level 23</h2>
<p>Mesma coisa no início, olho no cronjobs_bandit24.<br />
Você pode ver no script que ele executa que ele procura arquivos em uma determinada pasta e executa tudo que estiver la a todo minuto<br />
Então é simples!</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>cd /var/spool/bandit24
echo &quot;cat /etc/bandit_pass/bandit24 &gt; /tmp/n00bsb.bandit24&quot; &gt; script.sh
chmod +x script.sh
# agora basta esperar virar para o próximo minuto e
cat /tmp/n00bsb.bandit24
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ
</pre></div>


<h2>Level 24</h2>
<p>Brute Force!</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>for i in {0000..9999}; do
   echo  &quot;UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ $i&quot;; done | netcat localhost 30002 | grep bandit25
</pre></div>


<p>Dentro do loop geramos a lista com a senha do level 24 combinada com todas as combinações de 4 dígitos possíveis, e depois de pronta, jogamos essa lista via pipe pro netcat.<br />
Pode ser preciso rodar o comando algumas vezes, porque aparentemente o daemon não aguenta a pressão, mas é só insistir duas ou três vezes q vai dar certo.</p>
<h2>Level 25</h2>
<p>Essa eu apanhei muito. O shell do usuário bandit26 parece ser diferente, e é.<br />
Para passar desse nível, você deve redimensionar seu terminal, conforme a imagem abaixo:  </p>
<p><img alt="Screenshot from 2016-03-16 16-01-04" src="../../img/Screenshot-from-2016-03-16-16-01-04-300x61.png" />  </p>
<p>Ao dar enter, você vai se deparar com um "more"</p>
<p><img alt="Screenshot from 2016-03-16 16-01-40" src="../../img/Screenshot-from-2016-03-16-16-01-40-300x87.png" /><br />
O truque aqui é dar fallback do more para o vi!<br />
Digite esc, depois <strong>v</strong>.<br />
O arquivo será aberto no vi. Agora você só precisa digitar esc, e depois: <strong>e: /etc/bandit_pass/bandit26</strong> e enter.<br />
O arquivo bandit26 aparecerá com a senha.</p>
<div class="codehilite" style="background: #202020"><pre style="line-height: 125%"><span></span>5czgV9L3Xx8JPOyRbXh6lQbmIOWvPT6Z
</pre></div>


<p>Como o level 27 ainda não existe, acabamos de bater o desafio BANDIT do Overthewire!!</p>
                </div><!-- /.entry-content -->
        </article>
</section>
        </div><!--/span-->
        <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4>Membros</h4></li>
    <li><a target="_blank" href="https://github.com/atcasanova">atcasanova</a></li>
    <li><a target="_blank" href="https://">deadcow</a></li>
    <li><a target="_blank" href="https://github.com/fallc0nn">fallc0nn</a></li>
    <li><a target="_blank" href="https://">kirah</a></li>
    <li><a target="_blank" href="https://">Odysseus</a></li>
<li class="nav-header"><h4>Links</h4></li>
    <li><a target="_blank" href="https://asciinema.org/~fallc0nn">Asciinema (fallc0nn)</a></li>
    <li><a target="_blank" href="https://ctftime.org/team/24500">CTF-Time</a></li>
    <li><a target="_blank" href="https://github.com/n00bsb">Github</a></li>

<li class="nav-header"><h4>Categorias</h4></li>
<li><a href="../../category/ctf.html">CTF</a></li>
<li><a href="../../category/wargames.html">Wargames</a></li>

<li class="nav-header"><h4></i>Tags</h4></li>
<li class="tag-[<pelican.contents.Article object at 0x7f5012398a50>]"><a href="../../tag/ctf.html">#ctf</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7f5012364dd0>, <pelican.contents.Article object at 0x7f50122c8e50>]"><a href="../../tag/overthewireorg.html">#overthewire.org</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7f5012398a50>]"><a href="../../tag/sctf.html">#sctf</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7f5012364dd0>, <pelican.contents.Article object at 0x7f50122c8e50>]"><a href="../../tag/wargames.html">#wargames</a></li>
<li class="tag-[<pelican.contents.Article object at 0x7f5012398a50>, <pelican.contents.Article object at 0x7f5012364dd0>, <pelican.contents.Article object at 0x7f50122c8e50>]"><a href="../../tag/write-up.html">#write-up</a></li>

</ul>        </div><!--/.well -->
      </div><!--/row-->

      <footer></footer>
    
    </div><!--/.fluid-container-->
  </body>
</html>